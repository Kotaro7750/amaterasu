# 割り込み時の挙動

ハードウェア割り込み，割り込みディスクリプタのISTは0であることを想定．

n番の割り込みが起こったとする．

1. IDTが格納されているアドレスがIDTRから取得される
2. IDTの先頭アドレス+16*nバイト目から始まる16バイトがn番目の割り込みに対応する割り込みディスクリプタである．
3. 割り込みディスクリプタのセグメントセレクタ，ハンドラアドレスがそれぞれCSとRIPに格納される．
4. SSのセグメントセレクタには0+CPLがロードされる．
5. CSの書き換えによってCPLが変更された際には変更先の特権レベルに対応するRSPがTSSからロードされる．
6. 古いSS,RSP,RFLAGS,CS,RIPがスタックにこの順番にプッシュされる．CS,SSの16bit目以降は0埋めされる．
7. 割り込みの種類によってはエラーコードがスタックにプッシュされる．
8. 割り込みの処理が終わったらiret命令を実行することによって，スタックにプッシュされた情報が復元される．

## 参考文献
低レベルプログラミング(翔泳社) 6章
